$(document).ready(function(){$("#customer_autocomplete_template").length>0&&(window.customerTemplate=Handlebars.compile($("#customer_autocomplete_template").text())),formatCustomerResult=function(e){return customerTemplate({customer:e,bill_address:e.bill_address,ship_address:e.ship_address})},$("#customer_search").length>0&&$("#customer_search").select2({placeholder:Spree.translations.choose_a_customer,ajax:{url:Spree.routes.user_search,datatype:"json",data:function(e){return{q:e,token:Spree.api_key}},results:function(e){return{results:e.users}}},dropdownCssClass:"customer_search",formatResult:formatCustomerResult,formatSelection:function(e){$("#order_email").val(e.email),$("#user_id").val(e.id),$("#guest_checkout_true").prop("checked",!1),$("#guest_checkout_false").prop("checked",!0),$("#guest_checkout_false").prop("disabled",!1);var t=e.bill_address;return t&&($("#order_bill_address_attributes_firstname").val(t.firstname),$("#order_bill_address_attributes_lastname").val(t.lastname),$("#order_bill_address_attributes_address1").val(t.address1),$("#order_bill_address_attributes_address2").val(t.address2),$("#order_bill_address_attributes_city").val(t.city),$("#order_bill_address_attributes_zipcode").val(t.zipcode),$("#order_bill_address_attributes_phone").val(t.phone),$("#order_bill_address_attributes_country_id").select2("val",t.country_id).promise().done(function(){update_state("b",function(){$("#order_bill_address_attributes_state_id").select2("val",t.state_id)})})),Select2.util.escapeMarkup(e.email)}});var e=$("input#order_use_billing"),t=function(){e.is(":checked")?$("#shipping").hide():$("#shipping").show()};e.click(function(){t()}),t(),$("#guest_checkout_true").change(function(){$("#customer_search").val(""),$("#user_id").val(""),$("#checkout_email").val("");var e=["firstname","lastname","company","address1","address2","city","zipcode","state_id","country_id","phone"];$.each(e,function(e,t){$("#order_bill_address_attributes"+t).val(""),$("#order_ship_address_attributes"+t).val("")})})});