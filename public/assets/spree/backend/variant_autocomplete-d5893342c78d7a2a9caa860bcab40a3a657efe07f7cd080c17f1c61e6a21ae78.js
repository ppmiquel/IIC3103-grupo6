(function(){var t;$(document).ready(function(){$("#variant_autocomplete_template").length>0&&(window.variantTemplate=Handlebars.compile($("#variant_autocomplete_template").text()),window.variantStockTemplate=Handlebars.compile($("#variant_autocomplete_stock_template").text()),window.variantLineItemTemplate=Handlebars.compile($("#variant_line_items_autocomplete_stock_template").text()))}),t=function(t){return void 0!==t.images[0]&&void 0!==t.images[0].mini_url&&(t.image=t.images[0].mini_url),variantTemplate({variant:t})},$.fn.variantAutocomplete=function(){return this.select2({placeholder:Spree.translations.variant_placeholder,minimumInputLength:3,initSelection:function(t,e){return $.get(Spree.routes.variants_api+"/"+t.val(),{token:Spree.api_key},function(t){return e(t)})},ajax:{url:Spree.url(Spree.routes.variants_api),quietMillis:200,datatype:"json",data:function(t){return{q:{product_name_or_sku_cont:t},token:Spree.api_key}},results:function(t){return window.variants=t.variants,{results:t.variants}}},formatResult:t,formatSelection:function(t){return t.options_text?Select2.util.escapeMarkup(t.name+" ("+t.options_text+")"):Select2.util.escapeMarkup(t.name)}})}}).call(this);