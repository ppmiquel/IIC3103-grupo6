var initProductActions=function(){"use strict";if($(document).on("mouseover mouseout","a.delete",function(e){"mouseover"===e.type?$(this).parent().addClass("action-remove"):$(this).parent().removeClass("action-remove")}),$("#promotion-filters").find(".variant_autocomplete").variantAutocomplete(),$(".calculator-fields").each(function(){var e=$(this),t=e.find(".type-select"),o=e.find(".settings"),n=e.find(".js-warning"),i=t.val();n.hide(),t.change(function(){$(this).val()===i?(n.hide(),o.show(),o.find("input").removeProp("disabled")):(n.show(),o.hide(),o.find("input").prop("disabled","disabled"))})}),$("#promo-rule-option-value-template").length){var e=Handlebars.compile($("#promo-rule-option-value-option-values-select-name-template").html()),t=Handlebars.compile($("#promo-rule-option-value-template").html()),o=function(e,o){$(".js-promo-rule-option-values").append(t({productSelect:{value:e},optionValuesSelect:{value:o}}));var n=$(".js-promo-rule-option-values .promo-rule-option-value").last();n.find(".js-promo-rule-option-value-product-select").productAutocomplete({multiple:!1}),n.find(".js-promo-rule-option-value-option-values-select").optionValueAutocomplete({productSelect:".js-promo-rule-option-value-product-select"}),null===e&&n.find(".js-promo-rule-option-value-option-values-select").prop("disabled",!0)},n=$(".js-original-promo-rule-option-values").data("original-option-values");$(".js-original-promo-rule-option-values").data("loaded")||($.isEmptyObject(n)?o(null,null):$.each(n,o)),$(".js-original-promo-rule-option-values").data("loaded",!0),$(document).on("click",".js-add-promo-rule-option-value",function(e){e.preventDefault(),o(null,null)}),$(document).on("click",".js-remove-promo-rule-option-value",function(){$(this).parents(".promo-rule-option-value").remove()}),$(document).on("change",".js-promo-rule-option-value-product-select",function(){var t=$(this).parents(".promo-rule-option-value").find(".js-promo-rule-option-value-option-values-select");t.attr("name",e({productId:$(this).val()}).trim()),t.prop("disabled",""===$(this).val()).select2("val","")})}if($("#tier-fields-template").length&&$("#tier-input-name").length){var i=Handlebars.compile($("#tier-fields-template").html()),a=Handlebars.compile($("#tier-input-name").html()),l=$(".js-original-tiers").data("original-tiers");$.each(l,function(e,t){var o=a({base:e}).trim();$(".js-tiers").append(i({baseField:{value:e},valueField:{name:o,value:t}}))}),$(document).on("click",".js-add-tier",function(e){e.preventDefault(),$(".js-tiers").append(i({valueField:{name:null}}))}),$(document).on("click",".js-remove-tier",function(){$(this).parents(".tier").remove()}),$(document).on("change",".js-base-input",function(){var e=$(this).parents(".tier").find(".js-value-input");e.attr("name",a({base:$(this).val()}).trim())})}!function(){var e=function(){$(".promotion_action table").each(function(){0===$(this).find("td").length?$(this).hide():$(this).show()})};e();var t=function(){$(".remove_promotion_line_item").on("click",function(){var t=$($(".line_items_string")[0]),o=new RegExp($(this).data("variant-id")+"x\\d+");t.val(t.val().replace(o,"")),$(this).parents("tr").remove(),e()})};t(),$(".promotion_action.create_line_items button.add").unbind("click").click(function(){var o=$(this).parents(".promotion_action"),n=o.find('input[name="add_product_name"]').val(),i=o.find('input[name="add_variant_id"]').val(),a=o.find('input[name="add_quantity"]').val();if(i){var l="<tr><td>"+n+"</td><td>"+a+'</td><td><img src="/assets/admin/icons/cross.png"/></td></tr>';o.find("table").append(l);var r=o.find(".line_items_string");r.val(r.val()+","+i+"x"+a),t(),e()}return!1})}()};$(document).ready(function(){initProductActions()});