jQuery(function(e){e(".with-tip").tooltip(),e(".js-show-index-filters").click(function(){e(".filter-well").slideToggle(),e(this).parents(".filter-wrap").toggleClass("collapsed"),e("span.icon",e(this)).toggleClass("icon-chevron-down")}),e(".js-collapse-sidebar").click(function(){e(".main-right-sidebar").toggleClass("collapsed"),e("section.content").toggleClass("sidebar-collapsed"),e("span.icon",e(this)).toggleClass("icon-chevron-right"),e("span.icon",e(this)).toggleClass("icon-chevron-left")}),e("#main-sidebar").find('[data-toggle="collapse"]').on("click",function(){1==e(this).find(".icon-chevron-left").length?e(this).find(".icon-chevron-left").removeClass("icon-chevron-left").addClass("icon-chevron-down"):e(this).find(".icon-chevron-down").removeClass("icon-chevron-down").addClass("icon-chevron-left")});var t=e("#sidebar-toggle");t.on("click",function(){var t=e("#wrapper"),a=e("#main-part");t.hasClass("sidebar-minimized")?(t.removeClass("sidebar-minimized"),a.removeClass("col-sm-12 col-md-12 sidebar-collapsed").addClass("col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2"),e.cookie("sidebar-minimized","false",{path:"/admin"})):(t.addClass("sidebar-minimized"),a.removeClass("col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2").addClass("col-sm-12 col-md-12 sidebar-collapsed"),e.cookie("sidebar-minimized","true",{path:"/admin"}))}),e(".sidebar-menu-item").mouseover(function(){e("#wrapper").hasClass("sidebar-minimized")&&(e(this).addClass("menu-active"),e(this).find("ul.nav").addClass("submenu-active"))}),e(".sidebar-menu-item").mouseout(function(){e("#wrapper").hasClass("sidebar-minimized")&&(e(this).removeClass("menu-active"),e(this).find("ul.nav").removeClass("submenu-active"))}),e(".js-quick-search").val(e(".js-quick-search-target").val()),e("#quick-search").submit(function(){return e(".js-quick-search-target").val(e(".js-quick-search").val()),e("#table-filter form").submit(),!1});var a=e("#sidebar").find(".selected");a.parent().addClass("in"),a.parent().prev().find(".icon-chevron-left").removeClass("icon-chevron-left").addClass("icon-chevron-down"),e(".sort_link").each(function(){var t=e(this).text().replace("\xa0","");t.indexOf("\u25bc")>=0?(e(this).text(t.replace("\u25bc","")),e(this).append('<span class="icon icon-chevron-down"></span>')):t.indexOf("\u25b2")>=0&&(e(this).text(t.replace("\u25b2","")),e(this).append('<span class="icon icon-chevron-up"></span>'))}),e(".js-add-filter").click(function(){var t=e(this).data("ransack-field"),a=e(this).data("ransack-value");e("#"+t).val(a),e("#table-filter form").submit()}),e(document).on("click",".js-delete-filter",function(){var t=e(this).parents(".js-filter").data("ransack-field");e("#"+t).val(""),e("#table-filter form").submit()}),e(".js-filterable").each(function(){var t=e(this);if(t.val()){var a,s,i=t.attr("id"),n=e('label[for="'+i+'"]');a=t.is("select")?t.find("option:selected").text():t.val(),n=n.text()+": "+a,s='<span class="js-filter label label-default" data-ransack-field="'+i+'">'+n+'<span class="icon icon-delete js-delete-filter"></span></span>',e(".js-filters").append(s).show()}}),e(".js-per-page-select").change(function(){var t=e(this).closest(".js-per-page-form"),a=t.attr("action"),s=e(this).val().toString();a+=a.match(/\?/)?"&per_page="+s:"?per_page="+s,window.location=a}),e(document).ready(function(){var t=e(".js-per-page-select:first");if(t.length){var a=t.val().toString(),s='<input type="hidden" name="per_page" value='+a+" />";e("#table-filter form").append(s)}}),e("[data-toggle='offcanvas']").click(function(t){t.preventDefault(),e(window).width()<=992?(e(".row-offcanvas").toggleClass("active"),e(".left-side").removeClass("collapse-left"),e(".right-side").removeClass("strech"),e(".row-offcanvas").toggleClass("relative")):(e(".left-side").toggleClass("collapse-left"),e(".right-side").toggleClass("strech"))}),setTimeout('$(".alert-auto-disappear").slideUp()',5e3)}),$.fn.visible=function(e){this[e?"show":"hide"]()},show_flash=function(e,t){var a=$(".alert-"+e);0==a.length&&(a=$('<div class="alert alert-'+e+'" />'),$("#content").prepend(a)),a.html(t).show().delay(1e4).slideUp()},$.fn.radioControlsVisibilityOfElement=function(e){this.get(0)&&(showValue=this.get(0).value,radioGroup=$("input[name='"+this.get(0).name+"']"),radioGroup.each(function(){$(this).click(function(){$(e).visible(this.checked&&this.value==showValue)}),this.checked&&this.click()}))},handle_date_picker_fields=function(){$(".datepicker").datepicker({dateFormat:Spree.translations.date_picker,dayNames:Spree.translations.abbr_day_names,dayNamesMin:Spree.translations.abbr_day_names,firstDay:Spree.translations.first_day,monthNames:Spree.translations.month_names,prevText:Spree.translations.previous,nextText:Spree.translations.next,showOn:"focus"}),$(".date-range-filter .datepicker-from").datepicker("option","onSelect",function(e){$(".date-range-filter .datepicker-to").datepicker("option","minDate",e)}),$(".date-range-filter .datepicker-to").datepicker("option","onSelect",function(e){$(".date-range-filter .datepicker-from").datepicker("option","maxDate",e)})},$(document).ready(function(){handle_date_picker_fields(),$(".observe_field").on("change",function(){target=$(this).data("update"),$(target).hide(),$.ajax({dataType:"html",url:$(this).data("base-url")+encodeURIComponent($(this).val()),type:"get",success:function(e){$(target).html(e),$(target).show()}})});var e=1;$(".spree_add_fields").click(function(){var t=$(this).data("target"),a=$(t+" tr:visible:last").clone(),s=(new Date).getTime()+e++;a.find("input, select").each(function(){var e=$(this);e.val(""),e.prop("id",e.prop("id").replace(/\d+/,s)),e.prop("name",e.prop("name").replace(/\d+/,s))}),a.find("a").each(function(){var e=$(this);e.prop("href","#")}),$(t).prepend(a)}),$("body").on("click",".delete-resource",function(){var e=$(this);return confirm(e.data("confirm"))&&$.ajax({type:"POST",url:$(this).prop("href"),data:{_method:"delete",authenticity_token:AUTH_TOKEN},dataType:"script",success:function(){var t=$(".alert-success");t.length&&e.parents("tr").fadeOut("hide",function(){$(this).remove()})},error:function(e){show_flash("error",e.responseText)}}),!1}),$("body").on("click","a.spree_remove_fields",function(){return el=$(this),el.prev("input[type=hidden]").val("1"),el.closest(".fields").hide(),"#"==el.prop("href").substr(-1)?el.parents("tr").fadeOut("hide"):el.prop("href")&&$.ajax({type:"POST",url:el.prop("href"),data:{_method:"delete",authenticity_token:AUTH_TOKEN},success:function(){el.parents("tr").fadeOut("hide")},error:function(e){show_flash("error",e.responseText)}}),!1}),$("body").on("click",".select_properties_from_prototype",function(){$("#busy_indicator").show();var e=$(this);return $.ajax({dataType:"script",url:e.prop("href"),type:"get",success:function(){e.parent("td").parent("tr").hide(),$("#busy_indicator").hide()}}),!1});var t=function(e,t){return t.children().each(function(){$(this).width($(this).width())}),t};$("table.sortable").ready(function(){var e=$(this).find("tbody tr:first-child td").length;$("table.sortable tbody").sortable({handle:".handle",helper:t,placeholder:"ui-sortable-placeholder",update:function(e,t){$("#progress").show(),positions={},$.each($("table.sortable tbody tr"),function(e,t){reg=/spree_(\w+_?)+_(\d+)/,parts=reg.exec($(t).prop("id")),parts&&(positions["positions["+parts[2]+"]"]=e)}),$.ajax({type:"POST",dataType:"script",url:$(t.item).closest("table.sortable").data("sortable-link"),data:positions,success:function(){$("#progress").hide()}})},start:function(t,a){a.placeholder.height(a.item.height()),a.placeholder.html("<td colspan='"+(e-1)+"'></td><td class='actions'></td>")},stop:function(){$("table.sortable tr:even").removeClass("odd even").addClass("even"),$("table.sortable tr:odd").removeClass("odd even").addClass("odd")}})}),$("a.dismiss").click(function(){$(this).parent().fadeOut()}),window.Spree.advanceOrder=function(){$.ajax({type:"PUT",async:!1,data:{token:Spree.api_key},url:Spree.url(Spree.routes.checkouts_api+"/"+order_number+"/advance")}).done(function(){window.location.reload()})}});